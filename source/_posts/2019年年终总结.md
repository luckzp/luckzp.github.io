---
title: 2019年年终总结
urlname: zv98og
date: 2020-09-12 12:18:39 +0800
tags: []
categories: []
---

---



## title: 2019年年终总结date: 2019-12-30 22:32:37
tags: 个人提升

回顾1年工作的经历，现在想想能够让自己记忆深刻的事情，发现这些事情都是自己全身心投入进去的。

1. 
物流轨迹项目

从年初开始弄起，陆陆续续了弄了2,3个月。从最初接的快递鸟，采用数据库存储的方式。到现在采用Redis以物流单号为key,会员信息为value存储，对接了菜鸟。这个项目让我对RabbitMQ有了更深的了解，由于物流轨迹服务是不分集群的，根据不同队列会接受不同集群WMS的消息，然后订阅菜鸟。当菜鸟有消息过来时，又会将消息分发到不同集群的WMS，更新物流状态。一开始上线的时候，发现消息积压，20个消费者消费不了这么多消息，后来找尹凌英问了下调整到40个才解决。

后来随着对RabbitMQ削峰解耦的理解，将原先WMS调LTS接口订阅菜鸟改成发消息订阅，提高WMS的吞吐量。

物流轨迹目前这个功能还不够完善，只接了菜鸟，还有顺丰，京东，拼多多等平台还未对接。

2. 
到印尼帮助得力上线吉客云。

在出发去印尼前幻想着有一天可以清闲点到处逛逛。后来，我算是被打脸了。跟飞哥天天待在仓库里，帮忙上线吉客云。再加上印尼是热带气候，天天30度左右在仓库待了十几天。本来天气又热，再加上这里的网络真的是慢。打开一个页面不低于3s，后来好不容易上线了之后。回国后，一会Lazada的打印单子有问题，一会京东印尼打印单子有问题，又过一段时间Shoppe打印单子有问题。幸运的是，有欧世懿，何佳龙，黄景铺，董文华大佬们积极的帮助，一个个的帮客户解决。这个解决过程现在回想起非常温馨的，当出了问题，大家都不逃避，不推脱，一起想各种办法去解决问题。大家都有干劲，有激情，冲着解决问题去，这样一起工作的感觉非常棒。

当然了，印尼那边依然还有问题待解决，道阻且长。

PS:印尼人口有2亿多，市场潜力巨大，国内有滴滴，这里有go-jerk; 国内有美团，这里有Grab; 国内有淘宝，这里Tokopedia。很多与国内类似的商业模式在这里也成了独角兽。我在想，电商服务商是不是也可以复制到印尼了。

3. 
对称重和打包的重构。

在重构过程中借用翁嘉鑫年终总结的一句话：发现前辈们挖了不少的坑，他们事了拂衣去，留我加班至深夜。历史代码针对不同输入的单号会各种if-else，阅读起来困难。当时借着多包裹的需求，直接用策略模式对其重构，扫描物流单号有物流单号的策略，扫描发货单号有发货单号的策略，扫描包裹号有包裹的策略。重构完后，自己看代码就清爽多了。

示范仓的流水线和打包设备也一一对接。与北岱对接称重接口时，对方要求接口性能要好，也是优化，还好现在一直都很稳定。

4. 
直接发货的优化

在优化前，WMS会间隙性出现死锁，刘大专门做了个分享。对此，后来，我们WMS迅速修改代码。一开始对直接发货完全摸不到头脑的，觉得很复杂，要改的太多。后来想到多线程，但一开始对多线程不熟悉，就看了一些资料，看完后，实现了一番，发现经常死锁。本来准备放弃多线程的，和袁铭恩交流了下，告诉我还是要往多线程这边想想，就比如1000个单子1个人验货很慢，1000单10个人验货就会快很多。后来，我重新的实现了一遍扣减货位库存的逻辑，本地测的不死锁。后来一上线，没考虑到用户是十几个波次一起点直接发货，还是产生了死锁。辛好当时将死锁的线程try catch了然后用了countDownLatch，让用户可以重试直接发货。当天的还在排查为啥死锁，这时候金林刚开完OKR会议后回来和我说：试下对货位-货品-批次进行排序。经他这一提醒，我又想到了阿里规范（对多个资源、数据库表、对象同时加锁时，需要保持一致的加锁顺序，否则可能会造成死锁。）的排序能减少死锁，立即发了hotfix。后来果然死锁没了。接着，计算邮资也改成异步，直接发货的效率提升了许多，以前发200单要7s，现在400单要1s。这个事情，看了Mysql实战45讲和一些并发管理的文章，学到了很多，还是很开心的。

但是出库验货的性能这一块还需优化和调整。


---

2019 年也发现许多不足，于是立下 2020 年的 flag 去解决

1. 力求代码可读性高，多写点注释，多抽象方法。
2. 将业务代码和一些注意事项整理成文档，避免后人踩坑。
3. 保存谦卑，Stay hungry, Stay foolish。

---

我眼中的吉客云

吉客云有各种不足，性能问题，Bug 多，客户用的不顺畅，被客户和同事各种花式吐槽；本以为无望，但又能给客户真真正正的带来方便，提高发货效率。

吉客云就像一块璞玉，需要雕琢才成器。祝愿吉客云早日散发光彩，越来越好。
