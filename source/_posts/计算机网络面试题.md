---
title: 计算机网络面试题
urlname: imcsi4
date: 2020-09-12 12:19:59 +0800
tags: []
categories: []
---

---

## layout: posttitle: "计算机网络面试题"

date: 2017-9-8 21:58
comments: true
tags:

- 计算机网络

### 1.OSI 和 TCP/IP 的体系结构，以及各层协议

OSI 分层 （7 层）：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。

TCP/IP 分层（4 层）：数据链路层、 传输层、网络层、 应用层。

分层的好处：

- 各层之间的接口部分规划好之后，每个层次内部的设计就能自由改动了。
- 设计变得相对简单，每一层只考虑自己的分配任务。

每一层的协议如下：

物理层：RJ45、CLOCK、IEEE802.3 （中继器，集线器）

数据链路：PPP、FR、HDLC、VLAN、MAC （网桥，交换机）

网络层：IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP、 （路由器）

传输层：TCP、UDP、SPX

会话层：NFS、SQL、NETBIOS、RPC

表示层：JPEG、MPEG、ASII

应用层：FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS

每一层的作用如下：

物理层：通过媒介传输比特,确定机械及电气规范（比特 Bit）

数据链路层：将比特组装成帧和点到点的传递（帧 Frame）

网络层：负责数据包从源到宿的传递和网际互连（包 PackeT）

传输层：提供端到端的可靠报文传递和错误恢复（段 Segment）

会话层：建立、管理和终止会话（会话协议数据单元 SPDU）

表示层：对数据进行翻译、加密和压缩（表示协议数据单元 PPDU）

应用层：允许访问 OSI 环境的手段（应用协议数据单元 APDU）

### 2.TCP 的三次握手与四次分手

#### 摘自于http://www.jellythink.com/archives/705

#### 三次握手是什么？

TCP 是面向连接的，无论哪一方向另一方发送数据之前，都必须先在双方之间建立一条连接。在 TCP/IP 协议中，TCP 协议提供可靠的连接服务，连接是通过三次握手进行初始化的。三次握手的目的是同步连接双方的序列号和确认号并交换 TCP 窗口大小信息。这就是面试中经常会被问到的**TCP 三次握手**。只是了解 TCP 三次握手的概念，对你获得一份工作是没有任何帮助的，你需要去了解 TCP 三次握手中的一些细节。先来看图说话。

![](http://ww1.sinaimg.cn/large/aacc02d8gy1gce7qfxhnzj20lt0c2jyk.jpg#alt=%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png)

多么清晰的一张图，当然了，也不是我画的，我也只是引用过来说明问题了。

1. 第一次握手：建立连接。客户端发送连接请求报文段，将`SYN`位置为 1，`Sequence Number`为 x；然后，客户端进入`SYN_SEND`状态，等待服务器的确认；
2. 第二次握手：服务器收到`SYN`报文段。服务器收到客户端的`SYN`报文段，需要对这个`SYN`报文段进行确 认，设置`Acknowledgment Number`为 x+1(`Sequence Number`+1)；同时，自己自己还要发送`SYN`请求信息，将`SYN`位置为 1，`Sequence Number`为 y；服务器端将上述所有信息放到一个报文段（即`SYN+ACK`报文段）中，一并发送给客户端，此时服务器进入`SYN_RECV`状态；
3. 第三次握手：客户端收到服务器的`SYN+ACK`报文段。然后将`Acknowledgment Number`设置为 y+1，向服务器发送`ACK`报文段，这个报文段发送完毕以后，客户端和服务器端都进入`ESTABLISHED`状态，完成 TCP 三次握手。

![](http://ww1.sinaimg.cn/large/aacc02d8gy1gdajkp4qdxj21hc0t4why.jpg#alt=%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B-.png)

完成了三次握手，客户端和服务器端就可以开始传送数据。以上就是 TCP 三次握手的总体介绍。

**为了加深理解，举个例子。**

**A 和 B 之间建立了 TCP 连接，A 向 B 发送报文段，其中序号字段 seq=300，确认号字段 ACK =101，数据部分包含 7 个字节，那么在 B 对该报文的确认报文段中（）。**

**A. seq=301, ACK=101  B. seq=301, ACK=108  C.seq=101, ACK =107  D .seq=101, ACK= 307**

**解析：**

A 向 B 发送报文段，其中序号字段 seq=300，确认号字段 ACK =101。

A 对 B 说：“我已经收到你第 100 个序列号了，下个序列号要从 101 开始。我现在给你要以 300 序列号开始，给 7 个字节数据。“

B 这时应该对 A 说：”好的，我这就给你发送 101 的序列号，我这里收到了以 300 为起点，306 为终点的数据了，我现在要 307 序列号了。“

所以 B 对该报文的确认报文段中 seq=101, ACK= 307. 选 D.

#### 那四次分手呢？

当客户端和服务器通过三次握手建立了 TCP 连接以后，当数据传送完毕，肯定是要断开 TCP 连接的啊。那对于 TCP 的断开连接，这里就有了神秘的“四次分手”。

![](http://ww1.sinaimg.cn/large/aacc02d8gy1gce9y14bkgj20uy0i9n5x.jpg#alt=%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.png)

1. 第一次分手：主机 1（可以使客户端，也可以是服务器端），设置`Sequence Number`和`Acknowledgment Number`，向主机 2 发送一个`FIN`报文段；此时，主机 1 进入`FIN_WAIT_1`状态；这表示主机 1 没有数据要发送给主机 2 了；
2. 第二次分手：主机 2 收到了主机 1 发送的`FIN`报文段，向主机 1 回一个`ACK`报文段，`Acknowledgment Number`为`Sequence Number`加 1；主机 1 进入`FIN_WAIT_2`状态；主机 2 告诉主机 1，我“同意”你的关闭请求；
3. 第三次分手：主机 2 向主机 1 发送`FIN`报文段，请求关闭连接，同时主机 2 进入`LAST_ACK`状态；
4. 第四次分手：主机 1 收到主机 2 发送的`FIN`报文段，向主机 2 发送`ACK`报文段，然后主机 1 进入`TIME_WAIT`状态；主机 2 收到主机 1 的`ACK`报文段以后，就关闭连接；此时，主机 1 等待 2MSL 后依然没有收到回复，则证明 Server 端已正常关闭，那好，主机 1 也可以关闭连接了。

![](http://ww1.sinaimg.cn/large/aacc02d8gy1gdajm38dtdj21hc0t4gpa.jpg#alt=%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B-%E6%8A%93%E5%8C%85.png)

**等待 2MSL 才 CLOSED 的原因是：**

- 要确保服务器是否已经收到了我们的 ACK 报文，如果没有收到的话，服务器会重新发 FIN 报文给客户端，客户端再次收到 ACK 报文之后，就知道之前的 ACK 报文丢失了，然后再次发送 ACK 报文。
- 使已失效的连接请求报文段消失。

**为什么连接的时候是三次握手，关闭的时候却是四次握手？**

因为当 Server 端收到 Client 端的 SYN 连接请求报文后，可以直接发送 SYN+ACK 报文。其中 ACK 报文是用来应答的，SYN 报文是用来同步的。但是关闭连接时，当 Server 端收到 FIN 报文时，很可能并不会立即关闭 SOCKET，所以只能先回复一个 ACK 报文，告诉 Client 端，"你发的 FIN 报文我收到了"。只有等到我 Server 端所有的报文都发送完了，我才能发送 FIN 报文，因此不能一起发送。故需要四步握手。

### 3.子网划分

#### 现有两个 C 类网，202.203.204.0 ，把它平均分成 4 个子网，写出每个子网的起始、终结 IP 和子网掩码。

202.203.204.0 分成 4 个平均的子网，这是个 C 类的网络 ，平均分成 4 个的话，也就是每个子网有 64 台机器。

2 的 2 次方=4 ，所以需要借 2 个主机位表示 网络 ，等于是 26 位的子网掩码.

子网掩码: 202.203.204.192

子网号 **00** 202.203.204.1 ~ 202.203.204.63

子网号 **01** 202.203.204.64 ~ 202.203.204.127

子网号 **10** 202.203.204.128 ~ 202.203.204.191

子网号 **11** 202.203.204.192 ~ 202.203.204.254
